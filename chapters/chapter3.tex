\chapter{}
\label{cap:}
In this chapter it is explained how to improve the SOLAR framework in order to integrate the existing metrics with another set of metrics in order to provide the software engineer with more information regarding the architecture he's building. 

All modern applications are born to meet some functional requirements that often are subject to changes due to the fact that the environment where they operate is dynamic and can change in a unpredictable way. In the academic and industrial reality rose up the need to standardize some quality metrics in order to evaluate a software, this is the case of the \textbf{ISO/IEC 25010} standard called \emph{Systems and software Quality Requirements and Evaluation (SQuaRE)}\cite{iso/iec-25010}. However in the self-adaptive context these metrics are not of much help since they do not account the ability of these systems to auto adapt whenever they need it.

To overcome this problem some more new metrics have been defined that analyze the architecture in two different ways:
\begin{itemize}
	\item using a component diagram as defined in the UML standard\cite{uml} to analyze the static behavior
	\item using a sequence diagram as defined in the UML standard\cite{uml} to analyze the runtime behavior
\end{itemize}

The final objective is to define some adaptability metrics for the architecture as a whole and for every service that the architecture uses. In a more specific way what is shown is how important is every service in a architecture and as a consequence, how important is every component.

\section{Systems and software Quality Requirements and Evaluation (SQuaRE)}
\label{sec:square}
\textbf{ISO/IEC 25010}, \emph{Systems and software engineering — Systems and software Quality Requirements and Evaluation (SQuaRE)}\cite{iso/iec-25010} is an international standard for the evaluation of software quality that replaced the previous \textbf{ISO/IEC 9126} \emph{Software engineering — Product quality standard}\cite{iso/iec-9126}.

It presents eight product quality characteristics (in contrast to ISO 9126's six):
\begin{itemize}
	\item Functional suitability - degree to which a product or system provides functions that meet stated and implied needs when used under specified conditions
	\item Reliability - degree to which a system, product or component performs specified functions under specified conditions for a specified period of time
	\item Usability - degree to which a product or system can be used by specified users to achieve specified goals with effectiveness, efficiency and satisfaction in a specified context of use
	\item Performance efficiency - performance relative to the amount of resources used under stated conditions
	\item Maintainability - degree of effectiveness and efficiency with which a product or system can be modified by the intended maintainers
	\item Portability - degree of effectiveness and efficiency with which a system, product or component can be transferred from one hardware, software or other operational or usage environment to another
	\item Compatibility - degree to which a product, system or component can exchange information with other products, systems or components, and/or perform its required functions, while sharing the same hardware or software environment
	\item Security - degree to which a product or system protects information and data so that persons or other products or systems have the degree of data access appropriate to their types and levels of authorization
\end{itemize}

\section{The New Metrics}
\label{sec:new-metrics}
All the metrics shown in this section are focused on two primary quality attributes for the software engineer which are \emph{availability} and \emph{cost}. As a consequence two parameters must be given to perform some of the calculations:
\begin{itemize}
	\item \emph{$availability_{target}$} which represent the minimum availability the system must have
	\item \emph{$cost_{target}$} which represents the maximum cost the system must have
\end{itemize}
Both this parameters are given by the software engineer and come from the previous analysis of the requisites.

In table \ref{tab:new-metrics-summary} are summarized all the terms used in the equations.

\begin{table}[ht!b]
	\centering
	\begin{tabular}{|l|l|}
		\hline
		\multicolumn{1}{|c|}{Name} & \multicolumn{1}{c|}{Meaning} \\
		\hline 
		$availability_{target}$ & represent the minimum availability the system must have \\
		\hline
		$cost_{target}$ & represents the maximum cost the system must have \\ 
		\hline
		$C_i$ & Component \emph{i} \\ 
		\hline
		$T_{C_i}$ & Execution time for component \emph{i} \\
		\hline
		$PS_i$ & Provided service \emph{i} \\
		\hline
		$N_{exec_{PS_i}}$ & Number of executions of provided service \emph{i} \\
		\hline
		$T_{PS_i}$ & Execution Time of provided service \emph{i} \\
		\hline
		$TotTime$ & Total time of execution \\
		\hline
		$S_i$ & Service \emph{i} \\
		\hline
		$T_{S_i}$ & Execution time of service \emph{i} \\
		\hline
		$N_{exec_{S_i}}$ & Number of executions of service \emph{i} \\
		\hline
		$P_{exec_{S_i}}$ & Probability of execution service \emph{i} \\
		\hline
		$ExecPerCall_{S_i}$ & Number of execution per call of service \emph{i} \\
		\hline
		$N_{exec_{PS_i}}$ &  Number of executions of provided service \emph{i} \\
		\hline
		$$ & \\
		\hline
		$$ & \\
		\hline
		$$ & \\
		\hline
		$$ & \\
		\hline
	\end{tabular} 
	\caption[New Metrics]{Summary of the metrics.}
	\label{tab:new-metrics-summary}
\end{table}

\subsection{Components}
\subsubsection{Fitness ratio w.r.t. availability}
This metric Defines the ratio between a component availability and the target system availability. This result is from the hypothesis that a component with a high availability can provide, at first glance, more guarantees of functioning. 
\[ FRA \in \mathbb{R}^+_0 | FRA_{C_i} = \frac{1 - availability_{target}}{1- availability_{C_i}} \]

This means that if the result is $\ge 1$ the component satisfies the target requisite and as a consequence it can work for longer improving the availability of the service it offers. A value $\ge 0 $ and $<1$ indicates that this component is prone to failure more frequently than how is requested.

\subsubsection{Fitness ratio w.r.t. cost}
Defines the ratio between a component cost and the system target cost. 

\[ FRC \in  \mathbb{R}^+_0 | FRC_{C_i} = \frac{cost_{target}}{cost_{C_i}}\]

With the same component cost, if the system target cost grows higher the Fitness Ratio w.r.t. Cost becomes bigger. This implies that the bigger the component cost and the system target cost gap is, the more can be saved from buying this component w.r.t. the maximum budget invested in buying the component.

\subsubsection{Weight of residence time}
Calculates which fraction of time a component is running w.r.t total running time of the architecture.

\[ T_{C_i} \in \mathbb{R}^+ | T_{C_i} = \sum_{i=0}^{n} N_{exec_{PS_i}} * T_{PS_i} \]

\[ TotTime \in \mathbb{R^+} | TotTime = \sum_{i=0}^{n}N_{exec_{S_i}} * T_{S_i} \]

\[ WRT \in \mathbb{R}^+ | WRT = \frac{T_{C_i}}{TotTime} \]

Higher results means that the component runs more than others.

\subsection{Services}
\subsubsection{Number of executions}
Defines the number of times a service is executed.

\[ N_{exec_{S_i}} \in \mathbb{N} | \forall PS_i \;\, N_{exec_{S_i}} = \sum_{i=0}^{n} P_{exec_{S_i}} * ExecPerCall_{S_i} * N_{exec_{PS_i}} \]

\subsubsection{Probability to be running}
Defines the probability that a given service is running in a given moment.
\[ PTBR \in [0..1] | PTBR =  \frac{{N_{exec_{S_i}}}}{ \sum_{i=0}^{n}  N_{exec_{S_i}}} \]

\subsubsection{In Action}
This metrics calculates the probability to find a given service active considering the dynamic analysis of the architecture.
\[ TimeAction_{S_i} \in \mathbb{R}^+ | \sum_{j=0}^{n} T_{exec{S_i}Path_j} * P_{exec_{S_i}} \]
\[ InAction \in [0..1] | \frac{TimeAction_{S_i}}{{\sum_{i=0}^n}TimeAction_{S_i}} \]
It considers all the possible paths available in the selected workflow.

\subsection{Architecture}
\subsubsection{Global availability of system}
\subsubsection{Global cost of system}
\subsubsection{Total Static Availability}